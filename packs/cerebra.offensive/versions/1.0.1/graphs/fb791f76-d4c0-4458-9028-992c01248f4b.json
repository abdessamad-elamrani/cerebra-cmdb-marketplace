{
  "title": "LLMNR Poisoning with Responder & Hashcat",
  "version": "3.0",
  "description": "Executing a Man-in-the-Middle attack by poisoning LLMNR/NBT-NS broadcasts to capture NTLMv2 hashes, followed by offline dictionary cracking.",
  "shortDescription": "Poison broadcast traffic to steal and crack credentials",
  "tags": [
    "Responder",
    "LLMNR_Poisoning",
    "NBT-NS",
    "Credential_Access",
    "Hashcat",
    "Active_Directory",
    "MITM"
  ],
  "viewport": {
    "zoom": 0.85,
    "pan": {
      "x": 50,
      "y": 50
    }
  },
  "metadata": {
    "descriptionHtml": "<h3>Tool & Attack Description</h3><p>This scenario demonstrates a classic internal network compromise using <span style='color:#ef4444;font-weight:bold;'>Responder</span> and <span style='color:#ef4444;font-weight:bold;'>Hashcat</span>. The attacker exploits local name resolution protocols (LLMNR, NBT-NS) that Windows systems use when DNS fails.</p><h3>How attack works</h3><ol><li><strong>Poisoning</strong>: Responder listens for broadcast queries and answers them, pretending to be the target server.</li><li><strong>Capture</strong>: The victim's machine attempts to authenticate to the rogue server, revealing the user's NTLMv2 password hash.</li><li><strong>Cracking</strong>: The attacker takes this hash offline and uses Hashcat with a wordlist to recover the cleartext password.</li></ol>",
    "commandsBlock": "# Step 1: Start Responder with verbose output and WPAD support\nsudo responder -I eth0 -dwv\n\n# Step 2: Victim traffic is intercepted automatically...\n# [Responder] NTLMv2 Hash captured for User: CORP\\Alice\n\n# Step 3: Crack the captured hash (Mode 5600 = NTLMv2)\nhashcat -m 5600 -a 0 captured_hashes.txt rockyou.txt --force"
  },
  "entities": [
    {
      "id": "attacker_infra",
      "label": "Attacker Infrastructure",
      "type": "container",
      "icon": "IconKali",
      "members": [
        "responder_tool",
        "hashcat_tool",
        "captured_hash",
        "cracked_password"
      ]
    },
    {
      "id": "corp_network",
      "label": "Corporate Network",
      "type": "container",
      "icon": "IconCloud",
      "members": [
        "victim_ws"
      ]
    },
    {
      "id": "responder_tool",
      "label": "Responder",
      "type": "node",
      "icon": "IconTerminal",
      "parent": "attacker_infra"
    },
    {
      "id": "hashcat_tool",
      "label": "Hashcat",
      "type": "node",
      "icon": "IconTerminal",
      "parent": "attacker_infra"
    },
    {
      "id": "victim_ws",
      "label": "Victim Workstation",
      "type": "node",
      "icon": "IconWindows",
      "parent": "corp_network"
    },
    {
      "id": "captured_hash",
      "label": "NTLMv2 Hash",
      "type": "node",
      "icon": "IconStolenCredential",
      "parent": "attacker_infra"
    },
    {
      "id": "cracked_password",
      "label": "Cleartext Password",
      "type": "node",
      "icon": "IconStolenKey",
      "parent": "attacker_infra"
    }
  ],
  "steps": [
    {
      "id": 1,
      "type": "edge",
      "from": "attacker_infra",
      "to": "responder_tool",
      "name": "Initialize Listener",
      "description": "Start Responder to listen for LLMNR/NBT-NS broadcasts",
      "cli": "sudo responder -I eth0 -dwv",
      "icon": "IconTerminal"
    },
    {
      "id": 2,
      "type": "edge",
      "from": "victim_ws",
      "to": "responder_tool",
      "name": "Broadcast Query",
      "description": "Victim queries network for non-existent server",
      "icon": "IconSearch",
      "mitre": {
        "id": "T1557.001",
        "tactic": "Credential Access",
        "technique": "Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay"
      }
    },
    {
      "id": 3,
      "type": "edge",
      "from": "responder_tool",
      "to": "victim_ws",
      "name": "Poisoned Response",
      "description": "Responder spoofs the target server IP",
      "icon": "IconAttacker",
      "mitre": {
        "id": "T1557.001",
        "tactic": "Credential Access",
        "technique": "Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay"
      }
    },
    {
      "id": 4,
      "type": "edge",
      "from": "victim_ws",
      "to": "responder_tool",
      "name": "Send Auth Data",
      "description": "Victim automatically sends NTLMv2 hash to authenticate",
      "icon": "IconUser",
      "mitre": {
        "id": "T1557.001",
        "tactic": "Credential Access",
        "technique": "Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay"
      }
    },
    {
      "id": 5,
      "type": "edge",
      "from": "responder_tool",
      "to": "captured_hash",
      "name": "Capture Hash",
      "description": "Store intercept NTLMv2 hash to disk",
      "icon": "IconLock",
      "mitre": {
        "id": "T1003",
        "tactic": "Credential Access",
        "technique": "OS Credential Dumping"
      }
    },
    {
      "id": 6,
      "type": "edge",
      "from": "captured_hash",
      "to": "hashcat_tool",
      "name": "Import Hash",
      "description": "Load hash file into cracking tool",
      "icon": "IconData"
    },
    {
      "id": 7,
      "type": "edge",
      "from": "hashcat_tool",
      "to": "cracked_password",
      "name": "Crack Password",
      "description": "Run offline dictionary attack to recover cleartext",
      "cli": "hashcat -m 5600 hash.txt wordlist.txt",
      "icon": "IconExploit",
      "mitre": {
        "id": "T1110.002",
        "tactic": "Credential Access",
        "technique": "Brute Force: Password Cracking"
      }
    }
  ],
  "visibility": {
    "captured_hash": {
      "start": 5,
      "end": 100
    },
    "cracked_password": {
      "start": 7,
      "end": 100
    }
  }
}
